--- a/public_state_streets.py
+++ b/public_state_streets.py
@@ -40,37 +40,59 @@
 				self.is_showdown = True
 
 
-	def _advance_street_if_closed(self, actor: int) -> None:
-		def _advance():
-			if self.current_round < 3:
-				self.current_round = self.current_round + 1
-				self.current_bets = [0, 0]
-				self._reset_street_bookkeeping()
-				self._deal_for_new_street()
-				if self.current_round >= 1:
-					self.current_player = (self.dealer + 1) % 2
-				else:
-					self.current_player = self.dealer
-			else:
-				self.is_terminal = True
-				self.is_showdown = True
-		opp = (actor + 1) % 2
-		if self.players_in_hand[0] and self.players_in_hand[1]:
-			if self.current_bets[actor] == self.current_bets[opp]:
-				if self.last_raiser is not None:
-					if (
-						getattr(self, "_last_action_was_call_on_bet", False)
-						and int(self.current_round) == 0
-						and int(actor) == int(self.dealer)
-						and int(self.last_raiser) == (int(self.dealer) + 1) % 2
-					):
-						return
-					if getattr(self, "_last_action_was_call_on_bet", False):
-						_advance()
-						return
-					if actor == self.last_raiser:
-						_advance()
-						return
-				else:
-					if getattr(self, "_last_action_was_call_on_bet", False) or self.consecutive_checks >= 2:
-						_advance()
+    def _advance_street_if_closed(self, actor: int) -> None:
+        def _lr_norm(v):
+            if v is None:
+                return None
+            if isinstance(v, (tuple, list)):
+                return int(v[0]) if v else None
+            return int(v)
+        opp = (actor + 1) % 2
+        if self.players_in_hand[0] and self.players_in_hand[1]:
+            if self.current_bets[actor] == self.current_bets[opp]:
+                lr = _lr_norm(self.last_raiser)
+                if lr is not None:
+                    if getattr(self, "_last_action_was_call_on_bet", False):
+                        if int(self.current_round) == 0 and int(actor) == int(self.dealer) and int(lr) == (int(self.dealer) + 1) % 2:
+                            return
+                        if self.current_round < 3:
+                            self.current_round = self.current_round + 1
+                            self.current_bets = [0, 0]
+                            self._reset_street_bookkeeping()
+                            self._deal_for_new_street()
+                            if self.current_round >= 1:
+                                self.current_player = (self.dealer + 1) % 2
+                            else:
+                                self.current_player = self.dealer
+                        else:
+                            self.is_terminal = True
+                            self.is_showdown = True
+                        return
+                    if int(actor) == int(lr):
+                        if self.current_round < 3:
+                            self.current_round = self.current_round + 1
+                            self.current_bets = [0, 0]
+                            self._reset_street_bookkeeping()
+                            self._deal_for_new_street()
+                            if self.current_round >= 1:
+                                self.current_player = (self.dealer + 1) % 2
+                            else:
+                                self.current_player = self.dealer
+                        else:
+                            self.is_terminal = True
+                            self.is_showdown = True
+                else:
+                    if getattr(self, "_last_action_was_call_on_bet", False) or self.consecutive_checks >= 2:
+                        if self.current_round < 3:
+                            self.current_round = self.current_round + 1
+                            self.current_bets = [0, 0]
+                            self._reset_street_bookkeeping()
+                            self._deal_for_new_street()
+                            if self.current_round >= 1:
+                                self.current_player = (self.dealer + 1) % 2
+                            else:
+                                self.current_player = self.dealer
+                        else:
+                            self.is_terminal = True
+                            self.is_showdown = True
+
